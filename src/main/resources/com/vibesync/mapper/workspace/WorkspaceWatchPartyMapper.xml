<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.vibesync.workspace.mapper.WorkspaceWatchPartyMapper">

    <!-- 호스트 ID 목록에 해당하는 워치파티 목록 조회 -->
    <select id="selectWatchPartyListByHostId" resultType="com.vibesync.workspace.domain.WatchPartyDTO">
        SELECT 
            w.watchparty_idx as "watchparty.watchPartyIdx",
            w.title as "watchparty.title",
            w.video_id as "watchparty.videoId",
            w.created_at as "watchparty.createdAt",
            w.host as "host.ac_idx",
            u.nickname as "host.nickname",
            u.img as "host.profile_img",
            u.category_idx as "host.category_idx"
        FROM watchparty w
        JOIN userAccount u ON w.host = u.ac_idx
        <where>
            <if test="hostList != null and hostList.size() > 0">
                w.host IN
                <foreach collection="hostList" item="hostId" open="(" separator="," close=")">
                    #{hostId}
                </foreach>
            </if>
        </where>
        ORDER BY w.created_at DESC
    </select>

</mapper> 